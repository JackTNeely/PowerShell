# For use with PasswordExpiryEmails.ps1
# To be deployed as an Azure Function
{
  "bindings": [
    {
      "name": "timer",
      "type": "timerTrigger",
      "direction": "in",
      "schedule": "0 0 8 * * *"
    },
    {
      "name": "outputMessage",
      "type": "smtp",
      "direction": "out",
      "from": "sender@example.com",
      "to": "{userPrincipalName}",
      "subject": "Password Expiring Soon",
      "smtp": {
        "name": "smtp.office365.com",
        "port": 587,
        "encryption": "starttls",
        "username": "",
        "passwordSettingName": "SmtpPassword",
        "authenticationType": "OAuth2",
        "clientId": "",
        "clientAssertionCertificate": {
          "thumbprint": "myCertificateThumbprint",
          "certificateStore": "My"
        }
      }
    }
  ],
  "disabled": false,
  "scriptFile": "../bin/PasswordExpiryFunction.dll",
  "entryPoint": "PasswordExpiryFunction.Run",
  "bindingsExtension": {
    "AzureActiveDirectory": {
      "Authority": "https://login.microsoftonline.com/{your-tenant-id}/",
      "ClientId": "{your-client-id}",
      "Resource": "https://graph.windows.net/"
    }
  }
}
